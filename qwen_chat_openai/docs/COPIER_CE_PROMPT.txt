====================================================================
PROMPT √Ä COPIER-COLLER POUR LA PROCHAINE SESSION
====================================================================

Salut ! J'ai une app Flutter de chat FR‚ÜîZH (XiaoXin002) qui fonctionne bien. J'ai besoin d'am√©liorer l'UX avec 4 modifications.

CONTEXTE :
- Projet : C:\Users\ludov\OneDrive\Bureau\fck trans\fck-translation-\qwen_chat_openai\qwen_chat_openai\
- T√©l√©phone : FMMFSOOBXO8T5D75 (Xiaomi MIUI)
- √âmulateur : emulator-5554 (Chat API30lite)
- Cl√©s API dans : $env:OPENAI_API_KEY et $env:OPENAI_PROJECT
- Build : flutter build apk --release avec --dart-define pour les cl√©s
- NE PAS faire flutter clean sauf si code pas compil√© (perd 85 min)
- Apr√®s install : TOUJOURS faire force-stop puis start, sinon ancien code tourne !

OBJECTIFS (TODO LIST) :

[ ] 1. AUTO-SCROLL vers dernier message (5 min)
    - Quand message envoy√© ‚Üí scroll auto vers bas
    - Quand message re√ßu (WebSocket) ‚Üí scroll auto vers bas
    - Fichiers : chat_page.dart (ligne ~120) + chat_controller.dart (apr√®s state update)
    - Code : WidgetsBinding.instance.addPostFrameCallback + _listCtrl.animateTo(maxScrollExtent)

[ ] 2. D√âTECTION AUTOMATIQUE DE LANGUE (15 min)
    - D√©tecte si texte contient chinois (regex [\u4e00-\u9fff])
    - Si chinois ‚Üí traduit en fran√ßais
    - Si pas chinois ‚Üí traduit en chinois
    - ‚ö†Ô∏è SUPPRIMER le bouton swap (fl√®che üîÑ) dans AppBar (plus besoin avec auto-d√©tection)
    - Fichiers : chat_controller.dart (send() ligne ~234) + chat_page.dart (retirer IconButton swap ligne ~52-56)
    - Fonction : String _detectLanguage(String text)

[ ] 3. MASQUER MESSAGE ORIGINAL utilisateur (10 min)
    - Actuellement : J'√©cris "Bonjour" ‚Üí affiche ma bulle + bulle traduction (2 bulles)
    - Attendu : J'√©cris "Bonjour" ‚Üí affiche SEULEMENT la traduction "‰Ω†Â•Ω" (1 bulle)
    - Solution : Ne PAS cr√©er le userMsg (ligne ~251-260 chat_controller.dart)
    - Ou filtrer dans itemBuilder (chat_page.dart ligne ~81)

[ ] 4. POINT ROUGE notification DANS l'app (20 min)
    - Badge rouge dans AppBar avec compteur messages non lus
    - PAS sur ic√¥ne t√©l√©phone (impossible MIUI)
    - Badge DANS l'interface app (comme compteur notifs)
    - ‚ö†Ô∏è DISPARITION AUTO : Quand scroll atteint le bas (message lu) ‚Üí point rouge dispara√Æt automatiquement
    - Fichier : chat_page.dart AppBar (ligne ~49) + √©couter position scroll
    - Widget : Stack avec Positioned badge rouge + nombre
    - Logic : if (_listCtrl.position.pixels >= maxScrollExtent - 100) ‚Üí BadgeService.clear()

WORKFLOW :
1. Modifier le code
2. flutter build apk --release (avec toutes les --dart-define)
3. adb devices (si offline: adb kill-server && adb start-server)
4. Installer sur FMMFSOOBXO8T5D75 ET emulator-5554
5. Force-stop PUIS start (OBLIGATOIRE : com.example.qwen_chat_openai/.MainActivity)
6. Tester sur les deux appareils
7. ‚ö†Ô∏è IMPORTANT : Copier l'APK final dans dist/ pour lien de t√©l√©chargement (copine t√©l√©charge via lien)

CONTRAINTES :
- Build incr√©mental (2-5 min) >> Build clean (60-90 min)
- Toujours force-stop apr√®s install sinon ancien code !
- Supprimer bouton swap (fl√®che) car d√©tection auto suffit
- Point rouge dispara√Æt AUTO quand scroll en bas (message lu)
- ‚ö†Ô∏è √Ä LA FIN : Copier APK dans dist/ pour t√©l√©chargement copine via lien
- Tester d√©tection langue avec "Bonjour" ET "‰Ω†Â•Ω"
- V√©rifier scroll auto sur r√©ception WebSocket
- V√âRIFIER que l'APK final contient TOUTES les modifications (tester avant de copier dans dist/)

TEMPS TOTAL ESTIM√â : 1 heure

√âTAPE FINALE (CRITIQUE) :
Une fois TOUT test√© et valid√© sur les 2 appareils :
```
copy build\app\outputs\flutter-apk\app-release.apk dist\XiaoXin002-latest.apk
```
Ce fichier sera partag√© avec ma copine via lien de t√©l√©chargement.

Aide-moi √† impl√©menter ces 4 am√©liorations UX dans l'ordre de la TODO list. Merci !

====================================================================
INFOS COMPL√âMENTAIRES DANS : docs/PROMPT_NOUVELLE_SESSION.md
====================================================================

